<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3558 KVK SCHEDULE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
    body { 
      font-family: 'Orbitron', Arial, sans-serif; 
      margin: 0; 
      padding: 20px;
      background: #0d0a2b; 
      color: #e0d8ff; 
    }
    .container {
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
    }
    h2 { 
      text-align: center; 
      font-size: 2.5em;
      background: linear-gradient(90deg, #0abcf9, #ff0adc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 10px rgba(10, 188, 249, 0.5), 0 0 20px rgba(255, 10, 220, 0.5);
      margin-bottom: 30px;
    }
    table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-top: 20px; 
      border: 1px solid #3c2f8a;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td { 
      border: 1px solid #3c2f8a; 
      padding: 12px; 
      text-align: center; 
    }
    th { 
      background: #120e3a;
      color: #ff0adc;
      text-shadow: 0 0 5px rgba(255, 10, 220, 0.7);
    }
    td { background: rgba(13, 10, 43, 0.8); }
    .highlight { 
      font-weight: bold; 
      color: #0abcf9;
      text-shadow: 0 0 5px rgba(10, 188, 249, 0.7);
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>3558 KVK SCHEDULE</h2>
    <!-- Los inputs y el botón han sido eliminados de aquí -->
    <table>
      <thead>
        <tr>
          <th>Event</th>
          <th>Date & Time (UTC)</th>
        </tr>
      </thead>
      <tbody id="eventsTable"></tbody>
    </table>
  </div>

  <script>
    const baseEvents = [
      { name: "Ancient ruins", offsetDays: 21, siegeAffected: false },
      { name: "Pass 4*", offsetDays: 24, siegeAffected: false },
      { name: "Pass 6*", offsetDays: 34, siegeAffected: true },
      { name: "Altar of darkness", offsetDays: 35, siegeAffected: true },
      { name: "Pass 7", offsetDays: 45, siegeAffected: true },
      { name: "Pass 8", offsetDays: 48, siegeAffected: true },
      { name: "Great ziggurat", offsetDays: 54, siegeAffected: true },
      { name: "Pass 5", offsetDays: 57, siegeAffected: true },
      { name: "Pass 4", offsetDays: 61, siegeAffected: true },
    ];

    function formatDate(d) {
      return d.toLocaleDateString('en-US', { weekday: 'short', day: 'numeric', month: 'numeric' }) + " " +
             d.getUTCHours().toString().padStart(2,'0') + ":" + d.getUTCMinutes().toString().padStart(2,'0') + " UTC";
    }

    function parseTimeToHours(timeStr) {
      if (!timeStr || !timeStr.includes(':')) return 0;
      const [hh, mm, ss] = timeStr.split(":").map(Number);
      return hh + mm/60 + ss/3600;
    }

    function calculateDates() {
      // 1. Crear un objeto para leer los parámetros de la URL
      const urlParams = new URLSearchParams(window.location.search);

      // 2. Leer los valores desde la URL, con valores por defecto si no existen
      const regDateValue = urlParams.get('regDate') || '2025-08-18';
      const firstStepsValue = urlParams.get('firstSteps') || '13:00:00';
      const siegeLandValue = urlParams.get('siegeLand') || '25:00:00';
      
      // 3. El resto del código usa estas nuevas variables
      const regDate = new Date(regDateValue);
      const firstSteps = parseTimeToHours(firstStepsValue);
      const siegeLand = parseTimeToHours(siegeLandValue);

      const defaultFirstSteps = 24;
      const defaultSiegeLand = 48;
      const adjustFirst = firstSteps - defaultFirstSteps;
      const adjustSiege = siegeLand - defaultSiegeLand;

      let tbody = document.getElementById("eventsTable");
      tbody.innerHTML = "";

      baseEvents.forEach(ev => {
        let date = new Date(regDate);
        date.setUTCDate(date.getUTCDate() + ev.offsetDays);
        date.setUTCHours(1,0,0,0); 
        date.setUTCHours(date.getUTCHours() + adjustFirst);
        if (ev.siegeAffected) {
          date.setUTCHours(date.getUTCHours() + adjustSiege);
        }
        let row = `<tr><td class="highlight">${ev.name}</td><td>${formatDate(date)}</td></tr>`;
        tbody.innerHTML += row;
      });
    }

    // Run once on load
    calculateDates();
  </script>
</body>
</html>
